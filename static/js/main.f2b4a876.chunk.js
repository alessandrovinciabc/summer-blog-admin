(this.webpackJsonpsummerblogadmin=this.webpackJsonpsummerblogadmin||[]).push([[0],{116:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(31),s=n.n(r),i=(n(74),n(75),n(9)),o=n(34),l=n(32),u=n(1);var j=function(e){var t=e.auth;return Object(u.jsxs)(o.a,{className:e.className+"",variant:"light",expand:"md",children:[Object(u.jsx)(o.a.Brand,{href:"#/home",children:Object(u.jsx)("h1",{children:"\u2600\u26f1Admin"})}),Object(u.jsx)(o.a.Toggle,{"aria-controls":"header-navbar"}),Object(u.jsx)(o.a.Collapse,{id:"header-navbar",children:Object(u.jsxs)(l.a,{className:"ml-auto main-navigation",children:[Object(u.jsx)(l.a.Link,{className:"px-3",href:"#/home",children:"Posts"}),Object(u.jsx)(l.a.Link,{className:"px-3",href:"#/create",children:"Create new post"}),t?Object(u.jsx)(l.a.Link,{className:"px-3 bg-danger rounded",href:"#/logout",children:Object(u.jsx)("span",{className:"text-white",children:"Logout"})}):Object(u.jsx)(l.a.Link,{className:"px-3",href:"#/login",children:"Login"})]})})]})},d=n(7),h=n.n(d),b=n(12),f=n(22),m=n.n(f),p="https://summer-blog-api.herokuapp.com/blog/post",x="https://summer-blog-api.herokuapp.com/auth";function O(){return(O=Object(b.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get(p);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t,n){return g.apply(this,arguments)}function g(){return(g=Object(b.a)(h.a.mark((function e(t,n,a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post(p,{title:t,json:n},{headers:{Authorization:"Bearer ".concat(a)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=Object(b.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.delete("".concat(p,"/").concat(t),{headers:{Authorization:"Bearer ".concat(n)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t,n){return y.apply(this,arguments)}function y(){return(y=Object(b.a)(h.a.mark((function e(t,n,a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.put("".concat(p,"/").concat(t),n,{headers:{Authorization:"Bearer ".concat(a)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=Object(b.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("".concat(p,"/").concat(t,"/comment"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(b.a)(h.a.mark((function e(t,n,a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.delete("".concat(p,"/").concat(t,"/comment/").concat(n),{headers:{Authorization:"Bearer ".concat(a)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=Object(b.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("".concat(x,"/login"),{username:t,password:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=Object(b.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("".concat(x,"/test"),{},{headers:{Authorization:"Bearer ".concat(t)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=n(36),D=n(8);n(99);var B=function(){return Object(u.jsxs)("div",{className:"lds-roller",children:[Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)("div",{})]})},E=n(24),_=n(19),I=n(17);var P={save:function(e){localStorage.setItem("jwt",e)},get:function(e){return localStorage.getItem("jwt")},remove:function(){return localStorage.removeItem("jwt")}},T=["header","image","embed","list","paragraph"];var J={paragraph:function(e){var t=e.data;return"<p>".concat(t.text,"<p>")},header:function(e){var t=e.data;return"<h".concat(t.level,">").concat(t.text,"</h").concat(t.level,">")},list:function(e){var t=e.data,n="ordered"===t.style?"ol":"ul",a="";return t.items.forEach((function(e){a+="<li>".concat(e,"</li>")})),"<".concat(n,">").concat(a,"</").concat(n,">")},image:function(e){var t=e.data;return'<figure><img src="'.concat(t.url,'"/><figcaption>').concat(t.caption,"</figcaption></figure>")},embed:function(e){var t=e.data;return'<iframe width="'.concat(t.width,'" height="').concat(t.height,'" src="').concat(t.embed,'" frameborder="0" allowfullscreen></iframe>')}};var R=function(e){var t="";return e.forEach((function(e){var n=function(e){if("object"===typeof e&&"id"in e&&"type"in e&&"data"in e&&T.includes(e.type))return J[e.type](e)}(e);t+=n})),t},z=n(49),q=n(46),F=n.n(q),G={whiteList:Object(z.a)(Object(z.a)({},F.a.whiteList),{},{iframe:["width","height","src","frameborder","allowfullscreen"]})},X=function(e){return F()(e,G)};var H=function(e){var t=Object(D.g)().id,n=Object(a.useState)([]),c=Object(i.a)(n,2),r=c[0],s=c[1],o=Object(a.useState)(null),l=Object(i.a)(o,2),j=l[0],d=l[1],h=Object(a.useState)(""),b=Object(i.a)(h,2),f=b[0],m=b[1],p=e.posts,x=e.loading;return Object(a.useEffect)((function(){if(null!=t&&0!==p.length){var e=p.find((function(e){return e._id===t}));d(e);var n=JSON.parse(e.json);m(X(R(n.blocks))),function(e){return S.apply(this,arguments)}(t).then((function(e){s(e.data)})).catch((function(e){e.response.status}))}}),[t,p]),Object(u.jsx)(_.a,{className:"d-flex justify-content-center",fluid:!0,children:j?Object(u.jsxs)("div",{className:"post mt-4",children:[Object(u.jsx)(I.a,{onClick:function(){window.location.hash="#/post/".concat(t,"/edit")},children:"Edit\ud83d\udd8a"}),Object(u.jsx)("h1",{children:j.title}),Object(u.jsx)("p",{className:"text-muted",children:new Date(j.createdAt).toLocaleDateString()}),Object(u.jsx)("div",{className:"post-content",dangerouslySetInnerHTML:{__html:f}}),Object(u.jsxs)("section",{className:"comments my-5 pt-3 border-top",children:[Object(u.jsx)("header",{children:Object(u.jsx)("h2",{children:"Comments"})}),Object(u.jsx)("div",{children:r.length>0?r.map((function(e){return Object(u.jsxs)(E.a,{className:"post-summary my-3 w-100 pr-5",children:[Object(u.jsxs)(E.a.Body,{className:"pb-4 position-relative",children:[Object(u.jsx)(E.a.Title,{children:e.owner}),e.text,Object(u.jsx)("div",{className:"text-muted position-absolute comment-time",children:new Date(e.createdAt).toLocaleDateString()})]}),Object(u.jsx)(I.a,{onClick:function(){(function(e,t,n){return k.apply(this,arguments)})(t,e._id,P.get()).then((function(){window.location.reload()})).catch((function(){}))},className:"delete-btn rounded-right-only",variant:"danger",children:"X"})]},e._id)})):"Nothing here yet"})]})]}):x?Object(u.jsx)("div",{className:"mt-4",children:Object(u.jsx)(B,{})}):Object(u.jsx)("div",{className:"mt-4",children:"Post was not found."})})};function M(e){(function(e,t){return w.apply(this,arguments)})(e,P.get()).then((function(){window.location.reload()})).catch((function(e){}))}var U=function(e){var t=e.posts;return Object(u.jsx)(u.Fragment,{children:t&&t.length>0&&t.map((function(e){return Object(u.jsx)("div",{className:"w-100 d-flex justify-content-center align-items-center",children:Object(u.jsxs)(E.a,{className:"post-summary my-3 mx-auto pr-5",children:[Object(u.jsx)("a",{className:"text-reset post-link",href:"#/post/".concat(e._id),children:Object(u.jsxs)(E.a.Body,{children:[Object(u.jsx)(E.a.Title,{children:e.title}),Object(u.jsx)(E.a.Subtitle,{className:"text-muted",children:new Date(e.createdAt).toLocaleDateString()})]})}),Object(u.jsx)(I.a,{onClick:function(){M(e._id)},className:"delete-btn rounded-right-only",variant:"danger",children:"X"})]})},e._id)}))})};var K=function(e){var t=e.posts,n=e.loading;return Object(u.jsxs)(_.a,{fluid:!0,children:[Object(u.jsx)("h1",{className:"text-center mt-3",children:"Posts"}),Object(u.jsxs)("div",{className:"posts-container d-flex flex-column align-items-center",children:[n&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"mt-4",children:Object(u.jsx)(B,{})}),Object(u.jsx)("br",{})]}),t.length>0?Object(u.jsx)(U,{posts:t}):n?"":"Nothing here yet!"]})]})},Q=n(13),V=n(64),W=n.n(V),Y=n(65),Z=n.n(Y),$=n(66),ee=n.n($),te=n(67),ne=n.n(te),ae=n(68),ce=n.n(ae),re=c.a.forwardRef((function(e,t){var n=Object(a.useRef)(),c=Object(a.useRef)();return Object(a.useEffect)((function(){var t,a=new W.a({placeholder:"Type something...",data:null!==(t=e.data)&&void 0!==t?t:{},holder:c.current,tools:{header:{class:Z.a,config:{placeholder:"Enter a header",levels:[1,2,3,4,5,6],defaultLevel:2}},image:ee.a,list:{class:ne.a,inlineToolbar:!0},embed:{class:ce.a,inlineToolbar:!0}}});n.current=a}),[e.data]),Object(a.useEffect)((function(){t.current=n.current}),[t]),Object(u.jsx)("div",{ref:c})}));var se=function(e){var t=Object(a.useState)(""),n=Object(i.a)(t,2),c=n[0],r=n[1],s=Object(a.useState)(!1),o=Object(i.a)(s,2),l=o[0],j=o[1],d=Object(a.useRef)();function f(){return(f=Object(b.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),j(!0),e.prev=2,e.next=5,d.current.save();case 5:return n=e.sent,e.next=8,v(c,JSON.stringify(n),P.get());case 8:window.location.hash="#/",window.location.reload(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),alert("An error occurred");case 15:j(!1);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}return Object(u.jsxs)(_.a,{fluid:!0,children:[Object(u.jsx)("h1",{className:"text-center mt-3",children:"Create"}),Object(u.jsxs)("div",{className:"d-flex flex-column align-items-center",children:[l&&Object(u.jsx)("div",{className:"my-4",children:Object(u.jsx)(B,{})}),Object(u.jsx)("br",{}),Object(u.jsxs)(Q.a,{onSubmit:function(e){return f.apply(this,arguments)},className:"w-100 d-flex flex-column align-items-center",children:[Object(u.jsx)(Q.a.Control,{name:"title",type:"text",required:!0,maxLength:"60",autoComplete:"off",className:"title-input",value:c,onChange:function(e){r(e.target.value)}}),Object(u.jsxs)("div",{className:"mt-4",children:[Object(u.jsx)(I.a,{type:"submit",className:"mr-3",variant:"warning",children:"Add Post to Blog"}),Object(u.jsx)(I.a,{onClick:function(){r(""),d.current.blocks.clear()},variant:"danger",children:"Reset"})]})]})]}),Object(u.jsx)(_.a,{fluid:!0,className:"mt-4",children:Object(u.jsx)(re,{ref:d})})]})};var ie=function(e){var t=Object(D.g)().id,n=Object(a.useState)(null),c=Object(i.a)(n,2),r=c[0],s=c[1],o=Object(a.useState)(null),l=Object(i.a)(o,2),j=l[0],d=l[1],f=Object(a.useState)(!1),m=Object(i.a)(f,2),p=m[0],x=m[1],O=Object(a.useRef)(),v=e.posts,g=e.loading;function w(){return(w=Object(b.a)(h.a.mark((function e(n){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),x(!0),e.prev=2,e.next=5,O.current.save();case 5:return a=e.sent,e.next=8,N(t,{title:j,json:JSON.stringify(a)},P.get());case 8:window.location.hash="#/post/".concat(t),window.location.reload(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),alert("An error occurred");case 15:x(!1);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){if(null!=t&&0!==v.length){var e=v.find((function(e){return e._id===t}));s(e),d(e.title)}}),[t,v]),Object(u.jsx)(_.a,{className:"d-flex justify-content-center",fluid:!0,children:r?Object(u.jsxs)("div",{className:"post mt-4",children:[Object(u.jsxs)(Q.a,{onSubmit:function(e){return w.apply(this,arguments)},children:[Object(u.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(u.jsx)(I.a,{type:"submit",variant:"danger",className:"w-25 mr-3",children:"Save"}),Object(u.jsx)(I.a,{onClick:function(){window.location.hash="#/post/".concat(t)},variant:"primary",className:"w-25",children:"Cancel"})]}),Object(u.jsx)("div",{className:"d-flex flex-column align-items-center",children:p&&Object(u.jsx)("div",{className:"my-4",children:Object(u.jsx)(B,{})})}),Object(u.jsx)(Q.a.Control,{type:"text",required:!0,maxLength:"60",autoComplete:"off",className:"title-input my-3 edit-title-input",value:j,onChange:function(e){d(e.target.value)}})]}),Object(u.jsx)("p",{className:"text-muted",children:new Date(r.createdAt).toLocaleDateString()}),Object(u.jsx)(_.a,{fluid:!0,className:"mt-4",children:Object(u.jsx)(re,{ref:O,data:JSON.parse(r.json)})})]}):g?Object(u.jsx)("div",{className:"mt-4",children:Object(u.jsx)(B,{})}):Object(u.jsx)("div",{className:"mt-4",children:"Post was not found."})})},oe=n(69);var le=function(e){var t=Object(a.useState)(!1),n=Object(i.a)(t,2),c=n[0],r=n[1],s=e.setAuth;return Object(u.jsxs)(Q.a,{onSubmit:function(e){e.preventDefault();var t=e.target.elements,n=t.username,a=t.password;(function(e,t){return L.apply(this,arguments)})(n=n.value,a=a.value).then((function(e){P.save(e.data.jwt),s(e),window.location.hash="#/"})).catch((function(e){if(console.log(e),401===e.response.status)return r(!0)}))},children:[Object(u.jsxs)(Q.a.Group,{controlId:"formName",children:[Object(u.jsx)(Q.a.Label,{children:"Username"}),Object(u.jsx)(Q.a.Control,{name:"username",type:"text",required:!0,maxLength:"20",autoComplete:"off"})]}),Object(u.jsxs)(Q.a.Group,{controlId:"formPassword",children:[Object(u.jsx)(Q.a.Label,{children:"Password"}),Object(u.jsx)(Q.a.Control,{name:"password",type:"password",required:!0,maxLength:"100",autoComplete:"off"})]}),Object(u.jsx)(I.a,{className:"d-block mx-auto",variant:"primary",type:"submit",children:"Submit"}),c&&Object(u.jsx)(oe.a,{className:"mt-3",variant:"danger",children:"Invalid username or password"})]})};var ue=function(e){var t=e.loading,n=e.setAuth;return Object(u.jsx)(_.a,{className:"d-flex justify-content-center",fluid:!0,children:Object(u.jsxs)("div",{className:"mt-4",children:[Object(u.jsx)("h1",{children:"Login"}),t?Object(u.jsx)("div",{className:"mt-4",children:Object(u.jsx)(B,{})}):Object(u.jsx)(le,{setAuth:n})]})})};var je=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!0),s=Object(i.a)(r,2),o=s[0],l=s[1],d=Object(a.useState)(!1),h=Object(i.a)(d,2),b=h[0],f=h[1],m=Object(a.useState)(null),p=Object(i.a)(m,2),x=p[0],v=p[1];return Object(a.useEffect)((function(){(function(){return O.apply(this,arguments)})().then((function(e){c(e.data)})).finally((function(){l(!1)}));var e=P.get();if(null==e)return f(!0);(function(e){return C.apply(this,arguments)})(e).then((function(t){v(e)})).catch((function(e){P.remove()})).finally((function(){f(!0)}))}),[]),Object(u.jsx)(u.Fragment,{children:b&&Object(u.jsxs)(A.a,{children:[Object(u.jsx)(j,{className:"bg-header",auth:x}),Object(u.jsxs)(D.d,{children:[Object(u.jsxs)(D.b,{path:"/login",exact:!0,children:[x&&Object(u.jsx)(D.a,{to:"/"}),Object(u.jsx)(ue,{setAuth:v,loading:o})]}),Object(u.jsx)(D.b,{path:"/logout",exact:!0,render:function(){return P.remove(),v(null),Object(u.jsx)(D.a,{to:"/"})}}),null==x&&Object(u.jsx)(D.a,{to:"/login"}),Object(u.jsx)(D.b,{path:"/",exact:!0,children:Object(u.jsx)(D.a,{to:"/home"})}),Object(u.jsx)(D.b,{path:"/home",exact:!0,children:Object(u.jsx)(K,{posts:n,loading:o})}),Object(u.jsx)(D.b,{path:"/post/:id",exact:!0,children:Object(u.jsx)(H,{posts:n,loading:o})}),Object(u.jsx)(D.b,{path:"/post/:id/edit",exact:!0,children:Object(u.jsx)(ie,{posts:n,loading:o})}),Object(u.jsx)(D.b,{path:"/create",exact:!0,children:Object(u.jsx)(se,{loading:o})})]})]})})};s.a.render(Object(u.jsx)(je,{}),document.getElementById("root"))},75:function(e,t,n){},99:function(e,t,n){}},[[116,1,2]]]);
//# sourceMappingURL=main.f2b4a876.chunk.js.map